<!DOCTYPE html>

<html>
<head>
  <title>render.coffee</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="column.html">
                column.coffee
              </a>
            
              
              <a class="source" href="events.html">
                events.coffee
              </a>
            
              
              <a class="source" href="render.html">
                render.coffee
              </a>
            
              
              <a class="source" href="tablestakes.html">
                tablestakes.coffee
              </a>
            
              
              <a class="source" href="utils.html">
                utils.coffee
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>render.coffee</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class="highlight"><pre>window.TableStakesLib = {} <span class="keyword">unless</span> window.TableStakesLib
<span class="class"><span class="keyword">class</span> <span class="title">window</span>.<span class="title">TableStakesLib</span>.<span class="title">Core</span></span>

  constructor: (options) -&gt;
    <span class="property">@utils</span> = <span class="keyword">new</span> window.TableStakesLib.Utils
      core: @
    <span class="property">@events</span> = <span class="keyword">new</span> window.TableStakesLib.Events
      core: @

  set: (options) -&gt;
    <span class="property">@table</span> = options.table
    <span class="property">@selection</span> = options.selection
    <span class="property">@data</span> = options.data
    <span class="property">@columns</span> = <span class="property">@table</span>.columns()

  update: -&gt;
    <span class="property">@table</span>.isInRender = <span class="literal">true</span>
    <span class="property">@selection</span>.transition().call (selection) =&gt;
      <span class="property">@table</span>.update selection</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>responsible for &lt;table&gt; and contents</p>
<p>calls renderHead() for &lt;thead&gt; and contents
calls renderBody() for &lt;tbody&gt; and contents</p>

            </div>
            
            <div class="content"><div class="highlight"><pre>render: -&gt;
    <span class="property">@_buildData</span>()
    wrap = d3.select(<span class="property">@table</span>.el())
      .selectAll(<span class="string">"div"</span>)
      .data([[<span class="property">@nodes</span>]])
    wrapEnter = wrap.enter().append(<span class="string">"div"</span>)
    <span class="property">@tableEnter</span> = wrapEnter.append(<span class="string">"table"</span>)
    <span class="property">@tableObject</span> = wrap.select(<span class="string">"table"</span>)
      .classed(<span class="property">@table</span>.tableClassName,<span class="literal">true</span>)
      .attr(<span class="string">"style"</span>, <span class="string">"table-layout:fixed;"</span>)

    <span class="property">@_renderHead</span>(<span class="property">@tableObject</span>) <span class="keyword">if</span> <span class="property">@table</span>.header
    <span class="property">@_renderBody</span>(<span class="property">@tableObject</span>)
    <span class="property">@_makeDraggable</span>(<span class="property">@tableObject</span>) <span class="keyword">unless</span> <span class="property">@table</span>.isDraggable() <span class="keyword">is</span> <span class="literal">false</span>
    <span class="property">@_makeDeletable</span>(<span class="property">@tableObject</span>) <span class="keyword">unless</span> <span class="property">@table</span>.isDeletable() <span class="keyword">is</span> <span class="literal">false</span>

  _buildData: -&gt;
    <span class="property">@data</span>[<span class="number">0</span>] = id: <span class="property">@table</span>.noData <span class="keyword">unless</span> <span class="property">@data</span>[<span class="number">0</span>]
    <span class="property">@tree</span> = d3.layout.tree().children (d) -&gt; d.values
    <span class="property">@nodes</span> = <span class="property">@tree</span>.nodes(<span class="property">@data</span>[<span class="number">0</span>])</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>calculate number of columns</p>

            </div>
            
            <div class="content"><div class="highlight"><pre>depth = d3.max(<span class="property">@nodes</span>, (node) -&gt; node.depth)
    <span class="property">@tree</span>.size [<span class="property">@table</span>.height, depth * <span class="property">@table</span>.childIndent]</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>responsible for &lt;thead&gt; and contents</p>

            </div>
            
            <div class="content"><div class="highlight"><pre>_renderHead: (tableObject) -&gt;
    self = @</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>create table header and row</p>

            </div>
            
            <div class="content"><div class="highlight"><pre>theadRow = tableObject.selectAll(<span class="string">"thead"</span>)
      .data((d) -&gt; d)
      .enter()
        .append(<span class="string">"thead"</span>)
        .append(<span class="string">"tr"</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>append a &lt;th&gt; for each column</p>

            </div>
            
            <div class="content"><div class="highlight"><pre>th = theadRow.selectAll(<span class="string">"th"</span>)
      .data(<span class="property">@columns</span>)
      .enter()
        .append(<span class="string">"th"</span>)
          .text((d) -&gt; d.label)
          .attr(<span class="string">"ref"</span>, (d,i) -&gt; i)
          .attr(<span class="string">"class"</span>, (d) =&gt; <span class="property">@_columnClasses</span>(d))
          .style(<span class="string">'width'</span>, (d) -&gt; d.width)</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>for now, either all columns are resizable or none, set in table config</p>

            </div>
            
            <div class="content"><div class="highlight"><pre>theadRow.selectAll(<span class="string">"th"</span>).call(<span class="property">@_makeResizable</span>) <span class="keyword">if</span> <span class="property">@table</span>.isResizable()
    @</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>responsible for &lt;tbody&gt; and contents</p>

            </div>
            
            <div class="content"><div class="highlight"><pre>_renderBody: (tableObject) -&gt;
    <span class="property">@tbody</span> = tableObject.selectAll(<span class="string">"tbody"</span>).data((d) -&gt; d)
    <span class="property">@tbody</span>.enter().append <span class="string">"tbody"</span>
    <span class="property">@_renderRows</span>()

  _enterRows: -&gt;
    <span class="property">@enterRows</span> = <span class="property">@rows</span>
      .enter()
        .append(<span class="string">"tr"</span>)
        .attr(<span class="string">"class"</span>, (d) =&gt; <span class="property">@_rowClasses</span>(d))

  _updateRows: -&gt;
    self = @

    <span class="property">@updateRows</span> = <span class="property">@rows</span>.order()
    <span class="property">@_addRowEventHandling</span>()
    <span class="property">@updateRows</span>.select(<span class="string">'.expandable'</span>)
      .classed(<span class="string">'folded'</span>, <span class="property">@utils</span>.folded)

  _addRowEventHandling: -&gt;
    events =
      click: <span class="string">'elementClick'</span>
      dblclick: <span class="string">'elementDblclick'</span>
      mouseover: <span class="string">'elementMouseover'</span>
      mouseout: <span class="string">'elementMouseout'</span>

    <span class="function"><span class="title">addEvent</span></span> = (key, value) =&gt;
      <span class="property">@updateRows</span>.<span class="literal">on</span> key, (d) =&gt; <span class="property">@table</span>.dispatch.elementClick
        row: @
        data: d
        pos: [d.x, d.y]

    _.each events, (value, key) =&gt; addEvent(key, value)

  _exitRows: -&gt;
    <span class="property">@rows</span>
      .exit()
        .remove()

  _renderRows: -&gt;
    <span class="property">@rows</span> = <span class="property">@tbody</span>.selectAll(<span class="string">"tr"</span>)
      .data(((d) -&gt; d), (d) -&gt; d.id)
    <span class="property">@_enterRows</span>()
    <span class="property">@_updateRows</span>()
    <span class="property">@_exitRows</span>()

    d3.select(<span class="property">@enterRows</span>[<span class="number">0</span>][<span class="number">0</span>])
      .style(<span class="string">"display"</span>, <span class="string">"none"</span>) <span class="keyword">if</span> <span class="property">@enterRows</span>[<span class="number">0</span>][<span class="number">0</span>]
    <span class="property">@_renderEnterRows</span>()
    <span class="property">@_renderUpdateRows</span>()

  _renderEnterRows: -&gt;
    self = @
    <span class="property">@columns</span>.forEach (column, column_index) =&gt;
      <span class="property">@enterRows</span>.append(<span class="string">'td'</span>)
        .each (d, i) -&gt; self._renderCell(column, d, @)

  _renderUpdateRows: -&gt;
    self = @
    <span class="property">@updateRows</span>.selectAll(<span class="string">'td'</span>).each (d, i) -&gt;
      self._renderCell(self.columns[i], d, @) <span class="keyword">if</span> self.columns[i]?

  _renderCell: (column, d, td) -&gt;
    d3.select(td)
      .attr(<span class="string">'meta-key'</span>, column.id)
      .attr(<span class="string">'class'</span>, (d) =&gt; <span class="property">@_cellClasses</span>(d, column))
      .text((d) -&gt; d[column.id] <span class="keyword">or</span> <span class="string">'-'</span>)

    <span class="property">@_makeNested</span>(td) <span class="keyword">if</span> <span class="property">@utils</span>.ourFunctor(column.isNested, d)
    <span class="keyword">if</span> <span class="property">@utils</span>.ourFunctor(column.isEditable, d,column)
      <span class="property">@_makeEditable</span>(d, td, column)
    <span class="property">@_makeChanged</span>(d, td, column)
    <span class="property">@_makeBoolean</span>(d, td, column) <span class="keyword">if</span> column.editor <span class="keyword">is</span> <span class="string">'boolean'</span>
    <span class="property">@_makeSelect</span>(d, td, column) <span class="keyword">if</span> column.editor <span class="keyword">is</span> <span class="string">'select'</span>
    <span class="property">@_addShowCount</span>(d, td, column) <span class="keyword">if</span> column.showCount</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <h2>&quot;Class methods&quot; (tongue in cheek) define classes to be applied to tags</h2>
<p>Note: There are other methods that add/remove classes but these are the
primary points of contact</p>
<p>responsible for &lt;th&gt; classes
functions in column classes only to &lt;td&gt; nodes below,
not &lt;th&gt; nodes</p>

            </div>
            
            <div class="content"><div class="highlight"><pre>_columnClasses: (column) -&gt;
    column.classes <span class="keyword">unless</span> <span class="keyword">typeof</span> column.classes <span class="keyword">is</span> <span class="string">'function'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>responsible for &lt;tr&gt; classes
functions in column classes only to &lt;td&gt; nodes below,
not &lt;th&gt; nodes</p>

            </div>
            
            <div class="content"><div class="highlight"><pre>_rowClasses: (d) -&gt;
    <span class="property">@table</span>.rowClasses()(d) <span class="keyword">if</span> <span class="property">@table</span>.rowClasses()?</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>responsible for &lt;td&gt; classes
functions in column classes only to &lt;td&gt; nodes below,
not &lt;th&gt; nodes</p>

            </div>
            
            <div class="content"><div class="highlight"><pre>_cellClasses: (d, column) -&gt;
    val = []</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>retrieve classes specific to the column</p>

            </div>
            
            <div class="content"><div class="highlight"><pre>val.push <span class="keyword">if</span> column.classes?
      <span class="keyword">if</span> <span class="keyword">typeof</span> column.classes <span class="keyword">is</span> <span class="string">'function'</span>
        column.classes(d)
      <span class="keyword">else</span>
        column.classes

    val.push <span class="property">@utils</span>.nestedIcons(d) <span class="keyword">if</span> column <span class="keyword">is</span> <span class="property">@columns</span>[<span class="number">0</span>]</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>retrieve classes specified in data itself</p>

            </div>
            
            <div class="content"><div class="highlight"><pre>val.push d.classes <span class="keyword">if</span> d.classes?</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>return string split by spaces</p>

            </div>
            
            <div class="content"><div class="highlight"><pre>val.join(<span class="string">' '</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <h2>&quot;Transform methods&quot; apply optional behaviors and classes based on config</h2>
<h3>Table-level transform methods</h3>

            </div>
            
            <div class="content"><div class="highlight"><pre>_makeDraggable: (table) -&gt;
    self = @</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>add space in the table header</p>

            </div>
            
            <div class="content"><div class="highlight"><pre><span class="keyword">if</span> table.selectAll(<span class="string">'th.draggable-head'</span>)[<span class="number">0</span>].length <span class="keyword">is</span> <span class="number">0</span>
      table.selectAll(<span class="string">"thead tr"</span>)
        .append(<span class="string">'th'</span>)
          .attr(<span class="string">'width'</span>, <span class="string">'15px'</span>)
          .classed(<span class="string">'draggable-head'</span>, <span class="literal">true</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>add draggable &lt;td&gt;</p>

            </div>
            
            <div class="content"><div class="highlight"><pre><span class="property">@enterRows</span>.append(<span class="string">'td'</span>)
      .classed(<span class="string">'draggable'</span>, (d) =&gt; <span class="property">@utils</span>.ourFunctor(<span class="property">@table</span>.isDraggable(), d))

    <span class="property">@updateRows</span>.selectAll(<span class="string">'td.draggable'</span>).<span class="literal">on</span> <span class="string">'mouseover'</span>, (d) -&gt;
      self._setDragBehavior()
    .<span class="literal">on</span> <span class="string">'mouseout'</span>, (d) -&gt;
      self._clearDragBehavior()

  _setDragBehavior: -&gt;
    self = @
    dragBehavior = d3.behavior.drag()
      .origin(Object)
      .<span class="literal">on</span>(<span class="string">'dragstart'</span>, (d, x, y) -&gt; self.events.dragStart(@, d, x, y))
      .<span class="literal">on</span>(<span class="string">'drag'</span>,      (d, x, y) -&gt; self.events.dragMove(@, d, x, y))
      .<span class="literal">on</span>(<span class="string">'dragend'</span>,   (d, x, y) -&gt; self.events.dragEnd(@, d, x, y))
    <span class="property">@updateRows</span>.call dragBehavior

  _clearDragBehavior: -&gt;
    self = @
    dragBehavior = d3.behavior.drag()
      .origin(Object)
      .<span class="literal">on</span>(<span class="string">'dragstart'</span>, <span class="literal">null</span>)
      .<span class="literal">on</span>(<span class="string">'drag'</span>, <span class="literal">null</span>)
      .<span class="literal">on</span>(<span class="string">'dragend'</span>, <span class="literal">null</span>)
    <span class="property">@updateRows</span>.call dragBehavior

  _makeDeletable: (table) -&gt;</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>add space in the table header</p>

            </div>
            
            <div class="content"><div class="highlight"><pre><span class="keyword">if</span> table.selectAll(<span class="string">'th.deletable-head'</span>)[<span class="number">0</span>].length <span class="keyword">is</span> <span class="number">0</span>
      table.selectAll(<span class="string">"thead tr"</span>)
        .append(<span class="string">'th'</span>)
          .attr(<span class="string">'width'</span>, <span class="string">'15px'</span>)
          .classed(<span class="string">'deletable-head'</span>, <span class="literal">true</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>add deletable &lt;td&gt;</p>

            </div>
            
            <div class="content"><div class="highlight"><pre><span class="property">@enterRows</span>.append(<span class="string">'td'</span>)
      .classed(<span class="string">'deletable'</span>, (d) =&gt; <span class="property">@utils</span>.ourFunctor(<span class="property">@table</span>.isDeletable(), d))
      .<span class="literal">on</span> <span class="string">'click'</span>,
        (d) =&gt;
          <span class="property">@table</span>.onDelete()(d.id) <span class="keyword">if</span> <span class="property">@utils</span>.ourFunctor(<span class="property">@table</span>.isDeletable(), d)</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class="highlight"><pre>_makeResizable: (th) =&gt;</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>todo: clean up contexts</p>

            </div>
            
            <div class="content"><div class="highlight"><pre>self = @
    dragBehavior = d3.behavior.drag()
      .<span class="literal">on</span>(<span class="string">"drag"</span>, (a,b,c) -&gt; self.events.resizeDrag(self,@,a,b,c))
    th.classed(<span class="string">'resizeable'</span>,<span class="literal">true</span>)
      .append(<span class="string">"div"</span>)
      .classed(<span class="string">'resizeable-handle right'</span>, <span class="literal">true</span>)
      .call dragBehavior</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap for-h3">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <h3>Cell-level transform methods</h3>

            </div>
            
            <div class="content"><div class="highlight"><pre>_makeNested: (td) -&gt;
    d3.select(td)
      .attr(<span class="string">'class'</span>, (d) =&gt; <span class="property">@utils</span>.nestedIcons(d))
      .<span class="literal">on</span>(<span class="string">'click'</span>, (a,b,c) =&gt; <span class="property">@events</span>.nestedClick(@,a,b,c))

  _makeEditable: (d, td, column) -&gt;
    self = @

    <span class="keyword">return</span> <span class="keyword">if</span> _.contains [<span class="string">'boolean'</span>, <span class="string">'select'</span>], column.editor
    d3.select(td).classed(<span class="string">'editable'</span>, <span class="literal">true</span>)
    d3.select(td).classed(<span class="string">'calendar'</span>, <span class="literal">true</span>) <span class="keyword">if</span> column.editor <span class="keyword">is</span> <span class="string">'calendar'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>TODO: enable datepicker
$(&#39;.editable.calendar&#39;).datepicker()</p>

            </div>
            
            <div class="content"><div class="highlight"><pre>eventType = <span class="keyword">if</span> column.isNested <span class="keyword">then</span> <span class="string">'dblclick'</span> <span class="keyword">else</span> <span class="string">'click'</span>
    d3.select(td)
      .<span class="literal">on</span>(eventType, (a,b,c) -&gt; self.events.editableClick(<span class="keyword">this</span>,a,b,c,column))

    <span class="property">@_makeActive</span>(d, td, column) <span class="keyword">if</span> d.activatedID <span class="keyword">is</span> column.id

  _makeActive: (d, td, column) -&gt;
    self = @
    d3.select(td)
      .classed(<span class="string">'active'</span>, <span class="literal">true</span>)
      .attr(<span class="string">'contentEditable'</span>, <span class="literal">true</span>)
      .<span class="literal">on</span>(<span class="string">'keydown'</span>, (d) -&gt; self.events.keydown(<span class="keyword">this</span>, d, column))
      .<span class="literal">on</span>(<span class="string">'blur'</span>, (d) -&gt; self.events.blur(<span class="keyword">this</span>, d, column))
      .node()
        .focus()

  _makeChanged: (d, td, column) -&gt;
    <span class="keyword">if</span> d.changedID <span class="keyword">and</span> (i = d.changedID.indexOf(column.id)) <span class="keyword">isnt</span> -<span class="number">1</span>
      d3.select(td).classed(<span class="string">'changed'</span>, <span class="literal">true</span>)
      d.changedID.splice i, <span class="number">1</span>

  _makeSelect: (d, td, column) -&gt;
    select = d3.select(td)
      .html(<span class="string">'&lt;select class="expand-select"&gt;&lt;/select&gt;'</span>)
      .select(<span class="string">'.expand-select'</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>add current value</p>

            </div>
            
            <div class="content"><div class="highlight"><pre>select.append(<span class="string">'option'</span>)
      .style(<span class="string">'cursor'</span>, <span class="string">'pointer'</span>)
      .text(d[column.id])</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>add other options</p>

            </div>
            
            <div class="content"><div class="highlight"><pre>group = select.append(<span class="string">'optgroup'</span>).style(<span class="string">'cursor'</span>, <span class="string">'pointer'</span>)
    _.each _.without(column.selectOptions, d[column.id]), (item) =&gt;
      group.append(<span class="string">'option'</span>)
        .style(<span class="string">'cursor'</span>, <span class="string">'pointer'</span>)
        .text(item)

    select.<span class="literal">on</span>(<span class="string">'change'</span>, (a,b,c) =&gt; <span class="property">@events</span>.selectClick(@,a,b,c,column))

  _makeBoolean: (d, td, column) -&gt;
    d3.select(td)
      .classed(<span class="string">'boolean-true'</span>, d[column.id])
      .classed(<span class="string">'boolean-false'</span>, <span class="keyword">not</span> d[column.id])
      .<span class="literal">on</span>(<span class="string">'click'</span>, (a,b,c) =&gt; <span class="property">@events</span>.toggleBoolean(@,a,b,c,column))

  _addShowCount: (d, td, column) -&gt;
    count = d.values?.length <span class="keyword">or</span> d._values?.length
    d3.select(td).append(<span class="string">'span'</span>)
      .classed(<span class="string">'childrenCount'</span>, <span class="literal">true</span>)
      .text (d) -&gt; <span class="keyword">if</span> count <span class="keyword">then</span> <span class="string">'('</span> + count + <span class="string">')'</span> <span class="keyword">else</span> <span class="string">''</span></pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
